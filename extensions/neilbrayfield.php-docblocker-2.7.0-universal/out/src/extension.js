var W=Object.create;var w=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var q=Object.getOwnPropertyNames,L=Object.getOwnPropertySymbols,G=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var j=(p,e,t)=>e in p?w(p,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[e]=t,B=(p,e)=>{for(var t in e||(e={}))U.call(e,t)&&j(p,t,e[t]);if(L)for(var t of L(e))V.call(e,t)&&j(p,t,e[t]);return p};var O=p=>w(p,"__esModule",{value:!0});var Q=(p,e)=>{O(p);for(var t in e)w(p,t,{get:e[t],enumerable:!0})},K=(p,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of q(e))!U.call(p,n)&&n!=="default"&&w(p,n,{get:()=>e[n],enumerable:!(t=Z(e,n))||t.enumerable});return p},k=p=>K(O(w(p!=null?W(G(p)):{},"default",p&&p.__esModule&&"default"in p?{get:()=>p.default,enumerable:!0}:{value:p,enumerable:!0})),p);Q(exports,{activate:()=>Y,deactivate:()=>J});var d=k(require("vscode"));var y=k(require("vscode"));var x=k(require("vscode")),C=class{constructor(e,t){this.signatureEnd=/[\{;]/;this.position=e,this.editor=t,this.setSignature(this.getBlock(e,this.signatureEnd))}test(){return this.pattern.test(this.signature)}match(){return this.signature.match(this.pattern)}setSignature(e){this.signature=e}getBlock(e,t){let n=e.line+1,a=this.editor.document.lineAt(n).text,i=a.search(/[^\s]/);if(i===-1)return"";let l=new x.Position(e.line+1,i);for(;!t.test(a);)n++,a=this.editor.document.lineAt(n).text;let r=new x.Position(n,a.search(t)),s=new x.Range(l,r);return this.editor.document.getText(s)}getEnclosed(e,t,n){let a=0,i=e.split(""),l=0;for(let r=0;r<i.length;r++){let s=i[r];if(s==n&&a==0){l=r;break}else s==n?a--:s==t&&a++;l=r}return e.substr(0,l)}getSplitWithoutEnclosed(e,t=","){let n=new Array,a=e.split(""),i=["{","(","["],l=["}",")","]"],r=0,s=0,c=0;for(let b=0;b<a.length;b++){let T=a[b];if(T===t&&b===a.length-1)break;if(T===t&&r===0){c=b,n.push(e.substr(s,c-s)),s=b+1;continue}else i.indexOf(T)>=0?r++:l.indexOf(T)>=0&&r--;c=b}return e.substr(s,c-s+1).match(/^\s*$/)||n.push(e.substr(s,c-s+1)),n}getClassHead(){if(this.classHead===void 0){let e=this.editor.document.lineCount<300?this.editor.document.lineCount-1:300,t=this.editor.document.getText(new x.Range(new x.Position(0,0),new x.Position(e,0))),a=/\s*(abstract|final)?\s*(class|trait|interface)/gm.exec(t);if(a===null)this.classHead=null;else{let i=this.editor.document.positionAt(a.index),l=new x.Range(new x.Position(0,0),i);this.classHead=this.editor.document.getText(l)}}return this.classHead}};var M=k(require("vscode"));var F=k(require("vscode")),o=class{constructor(){this.isLive=!0}static get instance(){return this._instance==null&&(this._instance=new this),this._instance}set live(e){this.isLive=e}setFallback(e){this.data=e}override(e){this.data=B(B({},this.data),e)}get(e){return this.isLive?e==="autoClosingBrackets"?F.workspace.getConfiguration("editor").get(e):F.workspace.getConfiguration("php-docblocker").get(e):this.data[e]}};var v=class{constructor(e=""){this.params=[];this.indentCharacter=" ";this.message=e}fromObject(e){e.return!==void 0&&(this.return=e.return),e.var!==void 0&&(this.var=e.var),e.message!==void 0&&(this.message=e.message),e.params!==void 0&&Array.isArray(e.params)&&e.params.forEach(t=>{this.params.push(new S(t.type,t.name))})}build(e=!1){let t=o.instance.get("extra"),n=o.instance.get("gap"),a=o.instance.get("returnGap"),l=o.instance.get("alignParams")?o.instance.get("alignReturn"):!1,r="",s="",c="",g="",b="";e&&(n=!0,t=[]),b="${###"+(this.message!=""?":":"")+this.message+"}";let T=this.getMaxParamLength(this.params,this.return);if(this.params.length&&(c="",this.params.forEach(u=>{c!=""&&(c+=`
`);let h=u.type,f=u.name.replace("$","\\$"),z=this.getParamAlignmentSpaces(T,f,h);c+="@param "+(l?this.indentCharacter:"")+"${###:"+h+"} "+z.prepend+f+z.append;let I=o.instance.get("paramDescription");I===!0?c+="${###}":typeof I=="string"&&(c+="${###:"+I+"}")})),this.var){s="@var ${###:"+this.var+"}";let u=o.instance.get("varDescription");u===!0?s+=" ${###}":typeof u=="string"&&(s+=" ${###:"+u+"}")}if(this.return&&(this.return!="void"||o.instance.get("returnVoid"))){let u=this.getReturnAlignmentSpaces(T);r="@return ${###:"+this.return+"}"+u.append;let h=o.instance.get("returnDescription");h===!0?r+="${###}":typeof h=="string"&&(r+="${###:"+h+"}")}Array.isArray(t)&&t.length>0&&(g=t.join(`
`));let P=[];for(let u in this.template){let h=this.template[u],f;u=="message"&&b?(f=b,n&&(h.gapAfter=!0)):u=="var"&&s?f=s:u=="return"&&r?(f=r,a&&(h.gapBefore=!0)):u=="param"&&c?f=c:u=="extra"&&g?f=g:h.content!==void 0&&(f=h.content),f&&h.gapBefore&&P[P.length-1]!=""&&P.push(""),f&&P.push(f),f&&h.gapAfter&&P.push("")}P[P.length-1]==""&&P.pop();let $=P.join(`
`),H=0;return $=$.replace(/###/gm,function(){return H++,H+""}),$=$.replace(/^$/gm," *"),$=$.replace(/^(?!(\s\*|\/\*))/gm," * $1"),o.instance.get("autoClosingBrackets")=="never"?$=`
`+$+`
 */`:$=`/**
`+$+`
 */`,new M.SnippetString($)}set template(e){this._template=e}get template(){return this._template==null?{message:{},var:{},param:{},return:{},extra:{}}:this._template}getMaxParamLength(e,t){let n=o.instance.get("alignParams"),a=n?o.instance.get("alignReturn"):!1,i=0,l=0;return e.length&&n&&e.forEach(r=>{let s=r.type;s.length>i&&(i=s.length);let c=r.name.replace("$","\\$");c.length>l&&(l=c.length)}),t&&(t!="void"||o.instance.get("returnVoid"))&&a&&t.length>i&&(i=t.length),{type:i,name:l}}getParamAlignmentSpaces(e,t,n){let a=o.instance.get("alignParams"),i=o.instance.get("paramDescription"),l="",r="";return a&&(l=Array(e.type-n.length).fill(this.indentCharacter).join(""),r=Array(1+e.name-t.length).fill(this.indentCharacter).join("")),{append:i?a?r:this.indentCharacter:"",prepend:l}}getReturnAlignmentSpaces(e){let n=o.instance.get("alignParams")?o.instance.get("alignReturn"):!1,a=o.instance.get("returnDescription"),i="";return n&&(i=Array(1+e.type-this.return.length).fill(this.indentCharacter).join("")+Array(e.name).fill(this.indentCharacter).join("")),{append:a?n?i:this.indentCharacter:"",prepend:""}}},S=class{constructor(e,t){this.type=e,this.name=t}};var m=class{static get instance(){return this._instance||(this._instance=new this)}getResolvedTypeHints(e,t=null){let n=e.split(/([|&])/);for(let a=0;a<n.length;a+=2){if(n[a]===""){delete n[a],delete n[a+1];continue}n[a]=this.getFullyQualifiedType(n[a],t),n[a]=this.getFormattedTypeByName(n[a])}return n.join("")}getFullyQualifiedType(e,t){if(!t||!o.instance.get("qualifyClassNames"))return e;let n=/[\s;]?use\s+(?:(const|function)\s*)?([\s\S]*?)\s*;/gmi,a;for(;a=n.exec(t);){let i=a[1],l=a[2];if(i)continue;let r=this.getClassesFromUse(l)[e];if(r!==void 0)return r.charAt(0)!="\\"&&(r="\\"+r),r}return e}getClassesFromUse(e){let t,n;if(e.indexOf("{")!==-1){let l=e.indexOf("{"),r=(e+"}").indexOf("}");t=e.substring(0,l).trim(),n=e.substring(l+1,r).split(",")}else t="",n=e.split(",");var i={};for(let l=0;l<n.length;l++){let r,s=n[l].trim();s!==""&&(s=t+s,[s,r]=s.split(/\s+as\s+/gmi,2),(r===void 0||r==="")&&(r=s.substring(s.lastIndexOf("\\")+1)),i[r]=s)}return i}getFormattedTypeByName(e){switch(e){case"bool":case"boolean":return o.instance.get("useShortNames")?"bool":"boolean";case"int":case"integer":return o.instance.get("useShortNames")?"int":"integer";default:return e}}getTypeFromValue(e){let t;return e.match(/^\s*(false|true)\s*$/i)!==null||e.match(/^\s*\!/i)!==null?this.getFormattedTypeByName("bool"):e.match(/^\s*([\d-]+)\s*$/)!==null?this.getFormattedTypeByName("int"):e.match(/^\s*([\d.-]+)\s*$/)!==null?"float":e.match(/^\s*(["'])/)!==null||e.match(/^\s*<<</)!==null?"string":e.match(/^\s*(array\(|\[)/)!==null?"array":this.getDefaultType()}getDefaultType(){return o.instance.get("defaultType")}};var N=class extends C{constructor(){super(...arguments);this.pattern=/^\s*((.*)(protected|private|public))?(.*)?\s*function\s+&?([a-z0-9_]+)\s*\(([^{;]*)/im}parse(){let e=this.match(),t=new v("Undocumented function");t.template=o.instance.get("functionTemplate");let n=this.getEnclosed(e[6],"(",")"),a;if(n!=""){let r=this.getSplitWithoutEnclosed(n);o.instance.get("qualifyClassNames")&&(a=this.getClassHead());for(let s=0;s<r.length;s++){let g=r[s].match(/^\s*(?:(?:public|protected|private)\s+)?(?:readonly\s+)?(\?)?\s*([A-Za-z0-9_\\][A-Za-z0-9_\\|&]+)?\s*\&?((?:[.]{3})?\$[A-Za-z0-9_]+)\s*\=?\s*(.*)\s*/im);var i=m.instance.getDefaultType();g[2]!=null&&(i=m.instance.getResolvedTypeHints(g[2],a)),g[2]!=null&&g[1]==="?"||g[2]!=null&&g[4]!=null&&g[2]!="mixed"&&g[4]=="null"?i+="|null":g[4]!=null&&g[4]!=""&&g[2]!="mixed"&&(i=m.instance.getFormattedTypeByName(m.instance.getTypeFromValue(g[4]))),t.params.push(new S(i,g[3]))}}let l=this.signature.match(/.*\)\s*\:\s*(\?)?\s*([a-zA-Z_|0-9\\]+)\s*$/m);return l!=null?(l[2]=m.instance.getResolvedTypeHints(l[2],this.getClassHead()),t.return=l[1]==="?"?m.instance.getFormattedTypeByName(l[2])+"|null":m.instance.getFormattedTypeByName(l[2])):t.return=this.getReturnFromName(e[5]),t}getReturnFromName(e){if(/^(is|has|can|should)(?:[A-Z0-9_]|$)/.test(e))return m.instance.getFormattedTypeByName("bool");switch(e){case"__construct":case"__destruct":case"__set":case"__unset":case"__wakeup":return null;case"__isset":return m.instance.getFormattedTypeByName("bool");case"__sleep":case"__debugInfo":return"array";case"__toString":return"string"}return"void"}};var _=class extends C{constructor(){super(...arguments);this.pattern=/^\s*(static)?\s*(protected|private|public)\s+(static\s*)?(?:readonly\s*)?(\??\\?[a-zA-Z_\x7f-\xff][a-zA-Z0-9|_\x7f-\xff\\]+)?\s*(\$[A-Za-z0-9_]+)\s*\=?\s*([^;]*)/m}parse(){let e=this.match(),t=new v("Undocumented variable");if(t.template=o.instance.get("propertyTemplate"),e[4]){let n=e[4].match(/(\?)?(.*)/m),a;o.instance.get("qualifyClassNames")&&(a=this.getClassHead());let i=m.instance.getResolvedTypeHints(n[2],a);i=m.instance.getFormattedTypeByName(i),n[1]==="?"&&(i+="|null"),t.var=i}else e[6]?t.var=m.instance.getTypeFromValue(e[6]):t.var=m.instance.getDefaultType();return t}};var D=class extends C{constructor(){super(...arguments);this.pattern=/^\s*(abstract|final)?\s*(class|trait|interface)\s+([a-z0-9_]+)\s*/i}parse(){let e=this.match(),t=new v("Undocumented "+e[2]);return t.template=o.instance.get("classTemplate"),t}};var A=class{constructor(e,t){this.targetPosition=e.start,this.editor=t}autoDocument(){let e=new N(this.targetPosition,this.editor);if(e.test())return e.parse().build();let t=new _(this.targetPosition,this.editor);if(t.test())return t.parse().build();let n=new D(this.targetPosition,this.editor);return n.test()?n.parse().build():new v().build(!0)}};var R=class{constructor(){this.tagList=[{tag:"@api",snippet:"@api"},{tag:"@abstract",snippet:"@abstract"},{tag:"@after",snippet:"@after"},{tag:"@afterClass",snippet:"@afterClass"},{tag:"@author",snippet:"@author ${1:{{name}}} <${2:{{email}}}>"},{tag:"@backupGlobals",snippet:"@backupGlobals ${1:switch}"},{tag:"@backupStaticAttributes",snippet:"@backupStaticAttributes ${1:switch}"},{tag:"@before",snippet:"@before"},{tag:"@beforeClass",snippet:"@beforeClass"},{tag:"@category",snippet:"@category ${1:description}"},{tag:"@codeCoverageIgnore",snippet:"@codeCoverageIgnore"},{tag:"@codeCoverageIgnoreEnd",snippet:"@codeCoverageIgnoreEnd"},{tag:"@codeCoverageIgnoreStart",snippet:"@codeCoverageIgnoreStart"},{tag:"@copyright",snippet:"@copyright ${1:"+new Date().getFullYear()+"} ${2:Name}"},{tag:"@covers",snippet:"@covers ${1:fqcn}"},{tag:"@coversDefaultClass",snippet:"@coversDefaultClass ${1:fqcn}"},{tag:"@coversNothing",snippet:"@coversNothing"},{tag:"@dataProvider",snippet:"@dataProvider ${1:methodName}"},{tag:"@depends",snippet:"@depends ${1:methodName}"},{tag:"@deprecated",snippet:"@deprecated ${1:version}"},{tag:"@doesNotPerformAssertions",snippet:"@doesNotPerformAssertions"},{tag:"@example",snippet:"@example ${1:location} ${2:description}"},{tag:"@filesource",snippet:"@filesource"},{tag:"@final",snippet:"@final"},{tag:"@group",snippet:"@group ${1:group}"},{tag:"@global",snippet:"@global"},{tag:"@ignore",snippet:"@ignore ${1:description}"},{tag:"@inheritDoc",snippet:"@inheritDoc"},{tag:"@internal",snippet:"@internal ${1:description}"},{tag:"@large",snippet:"@large"},{tag:"@license",snippet:"@license ${1:MIT}"},{tag:"@link",snippet:"@link ${1:http://url.com}"},{tag:"@medium",snippet:"@medium"},{tag:"@method",snippet:"@method ${1:mixed} ${2:methodName()}"},{tag:"@mixin",snippet:"@mixin ${1:\\MyClass}"},{tag:"@package",snippet:"@package ${1:category}"},{tag:"@param",snippet:"@param ${1:mixed} $${2:name}"},{tag:"@preserveGlobalState",snippet:"@preserveGlobalState ${1:switch}"},{tag:"@property",snippet:"@property ${1:mixed} $${2:name}"},{tag:"@property-read",snippet:"@property-read ${1:mixed} $${2:name}"},{tag:"@property-write",snippet:"@property-write ${1:mixed} $${2:name}"},{tag:"@requires",snippet:"@requires ${1:mixed}"},{tag:"@return",snippet:"@return ${1:mixed}"},{tag:"@runInSeparateProcess",snippet:"@runInSeparateProcess"},{tag:"@runTestsInSeparateProcesses",snippet:"@runTestsInSeparateProcesses"},{tag:"@see",snippet:"@see ${1:http://url.com}"},{tag:"@since",snippet:"@since ${1:1.0.0}"},{tag:"@small",snippet:"@small"},{tag:"@source",snippet:"@source ${1:location} ${2:description}"},{tag:"@static",snippet:"@static"},{tag:"@subpackage",snippet:"@subpackage ${1:category}"},{tag:"@test",snippet:"@test"},{tag:"@testdox",snippet:"@testdox ${1:description}"},{tag:"@testWith",snippet:"@testWith ${1:elements}"},{tag:"@throws",snippet:"@throws ${1:Exception}"},{tag:"@ticket",snippet:"@ticket ${1:ticket}"},{tag:"@todo",snippet:"@todo ${1:Something}"},{tag:"@uses",snippet:"@uses ${1:MyClass::function} ${2:Name}"},{tag:"@var",snippet:"@var ${1:mixed}"},{tag:"@version",snippet:"@version ${1:1.0.0}"},{tag:"@psalm-var (Psalm)",snippet:"@psalm-var ${1:mixed}"},{tag:"@psalm-param (Psalm)",snippet:"@psalm-param ${1:mixed} $${2:name}"},{tag:"@psalm-return (Psalm)",snippet:"@psalm-return ${1:mixed}"},{tag:"@psalm-suppress (Psalm)",snippet:"@psalm-suppress ${1:IssueName}"},{tag:"@psalm-assert (Psalm)",snippet:"@psalm-assert ${1:[assertion]} $${2:var}"},{tag:"@psalm-assert-if-true (Psalm)",snippet:"@psalm-assert-if-true ${1:[assertion]} $${2:var}"},{tag:"@psalm-assert-if-false (Psalm)",snippet:"@psalm-assert-if-false ${1:[assertion]} $${2:var}"},{tag:"@psalm-ignore-nullable-return (Psalm)",snippet:"@psalm-ignore-nullable-return"},{tag:"@psalm-ignore-falsable-return (Psalm)",snippet:"@psalm-ignore-falsable-return"},{tag:"@psalm-seal-properties (Psalm)",snippet:"@psalm-seal-properties"},{tag:"@psalm-internal (Psalm)",snippet:"@psalm-internal ${1:Namespace}"},{tag:"@psalm-readonly (Psalm)",snippet:"@psalm-readonly"},{tag:"@psalm-mutation-free (Psalm)",snippet:"@psalm-mutation-free"},{tag:"@psalm-external-mutation-free (Psalm)",snippet:"@psalm-external-mutation-free"},{tag:"@psalm-immutable (Psalm)",snippet:"@psalm-immutable"},{tag:"@psalm-pure (Psalm)",snippet:"@psalm-pure"},{tag:"@phan-suppress (Phan)",snippet:"@phan-suppress ${1:IssueName}"},{tag:"@suppress (Phan)",snippet:"@suppress ${1:IssueName}"},{tag:"@phan-suppress-current-line (Phan)",snippet:"@phan-suppress-current-line ${1:IssueName, IssueName}"},{tag:"@phan-suppress-next-line (Phan)",snippet:"@phan-suppress-next-line ${1:IssueName, IssueName}"},{tag:"@phan-file-suppress (Phan)",snippet:"@phan-file-suppress ${1:IssueName}"},{tag:"@override (Phan)",snippet:"@override"},{tag:"@inherits (Phan)",snippet:"@inherits"},{tag:"@phan-assert (Phan)",snippet:"@phan-assert ${1:[assertion]} $${2:var}"},{tag:"@phan-assert-true-condition (Phan)",snippet:"@phan-assert-true-condition ${1:[assertion]} $${2:var}"},{tag:"@phan-assert-false-condition (Phan)",snippet:"@phan-assert-false-condition ${1:[assertion]} $${2:var}"},{tag:"@phan-closure-scope (Phan)",snippet:"@phan-closure-scope"},{tag:"@phan-read-only (Phan)",snippet:"@phan-read-only"},{tag:"@phan-write-only (Phan)",snippet:"@phan-write-only"},{tag:"@phan-pure (Phan)",snippet:"@phan-pure"},{tag:"@phan-phan-output-reference (Phan)",snippet:"@param ${1:mixed} $${2:name} @phan-phan-output-reference"},{tag:"@phan-phan-ignore-reference (Phan)",snippet:"@param ${1:mixed} $${2:name} @phan-phan-ignore-reference"},{tag:"@phan-var (Phan)",snippet:"@phan-var ${1:mixed}"},{tag:"@phan-param (Phan)",snippet:"@phan-param ${1:mixed} $${2:name}"},{tag:"@phan-return (Phan)",snippet:"@phan-return ${1:mixed}"},{tag:"@phan-return (Phan)",snippet:"@phan-return ${1:mixed}"},{tag:"@phan-method (Phan)",snippet:"@phan-method ${1:mixed} ${2:methodName()}"},{tag:"@template (Phan)",snippet:"@template"}]}get list(){return this.tagList}};var E=class{constructor(){this.tags=new R}provideCompletionItems(e,t,n){let a=[],i;if((i=e.getWordRangeAtPosition(t,/\/\*\*/))!==void 0){let s=new A(i,y.window.activeTextEditor),c=new y.CompletionItem("/**",y.CompletionItemKind.Snippet);c.detail="PHP DocBlocker",c.documentation="Generate a PHP DocBlock from the code snippet below.";let g=e.getWordRangeAtPosition(t,/\/\*\* \*\//);return c.range=g,c.insertText=s.autoDocument(),a.push(c),a}if((i=e.getWordRangeAtPosition(t,/\@[a-z]*/))===void 0)return a;let l=e.getText(i);return this.getTags().filter(s=>s.tag.match(l)!==null).forEach(s=>{let c=new y.CompletionItem(s.tag,y.CompletionItemKind.Snippet);c.range=i,c.insertText=new y.SnippetString(s.snippet),a.push(c)}),a}getTags(){let e=this.tags.list;return e.forEach((t,n)=>{t.tag=="@author"&&(t.snippet=t.snippet.replace("{{name}}",o.instance.get("author").name),t.snippet=t.snippet.replace("{{email}}",o.instance.get("author").email),e[n]=t)}),e}};function Y(p){["php","hack"].forEach(e=>{e=="hack"&&d.languages.setLanguageConfiguration(e,{wordPattern:/(-?\d*\.\d\w*)|([^\-\`\~\!\@\#\%\^\&\*\(\)\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\?\s]+)/g,onEnterRules:[{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:d.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:d.IndentAction.None,appendText:" * "}},{beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:d.IndentAction.None,appendText:"* "}},{beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/,action:{indentAction:d.IndentAction.None,removeText:1}}]}),d.languages.registerCompletionItemProvider(e,new E,"*","@")}),d.commands.registerTextEditorCommand("php-docblocker.trigger",e=>{e.selection=new d.Selection(e.selection.start,e.selection.start);let t=new d.Range(e.selection.start,e.selection.end),a=new A(t,e).autoDocument();e.insertSnippet(a)})}function J(){}0&&(module.exports={activate,deactivate});
